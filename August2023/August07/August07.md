# 20230807 High-Performance Analog Circuit Design Lecture 08 feedback and stability analysis

å¥ˆå¥æ–¯ç‰¹ç¨³å®šæ€§åˆ¤æ®

![Untitled](IMAGE/Untitled.png)

Good online tutorial videos:

- [https://www.youtube.com/watch?v=sof3meN96MA](https://www.youtube.com/watch?v=sof3meN96MA)
- [https://www.youtube.com/watch?v=FXbKYT1G6Xs](https://www.youtube.com/watch?v=FXbKYT1G6Xs)

<aside>
ğŸ’¡ å¥ˆå¥æ–¯ç‰¹åˆ¤æ®æ˜¯ä¸€ä¸ªæ›´å…¨é¢çš„åˆ¤æ®ï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹ç”¨å·´å…‹è±ªæ–¯ç¨³å®šæ€§åˆ¤æ®ä¹Ÿå¤Ÿç”¨äº†

</aside>

# 3. ç”µå®¹è´Ÿåé¦ˆçš„æ”¾å¤§å™¨

ä»¥ä»¥ä¸‹ç”µå®¹è´Ÿåé¦ˆæ”¾å¤§å™¨ä¸ºä¾‹åˆ†æ

![Untitled](IMAGE/Untitled%201.png)

åˆ†æè¯¥ç”µè·¯çš„ï¼š

- ç”µè·¯çš„ç¨³å®šæ€§ï¼Œç›¸ä½è£•åº¦æ˜¯å¤šå°‘
- ä½é¢‘é—­ç¯å¢ç›Šæ˜¯å¤šå°‘
- é—­ç¯å¸¦å®½æ˜¯å¤šå°‘

## 3.1 å†™å‡ºå°ä¿¡å·æ¨¡å‹

è§‚å¯Ÿå°ä¿¡å·æ¨¡å‹å‘ç°**å¾ˆéš¾**å†™æˆæ ‡å‡†çš„è´Ÿåé¦ˆé—­ç¯ï¼ˆafï¼‰å½¢å¼

- è´Ÿåé¦ˆç½‘ç»œä½œä¸ºè¿æ”¾çš„è´Ÿè½½çš„ä¸€éƒ¨åˆ†
- è¿æ”¾ä¹Ÿæ˜¯è´Ÿåé¦ˆç½‘ç»œçš„ä¸€éƒ¨åˆ†
- é«˜é¢‘ä¸‹æœ‰ä¸€æ¡bypassæ”¾å¤§å™¨çš„å‰é¦ˆé€šè·¯

![Untitled](IMAGE/Untitled%202.png)

<aside>
ğŸ’¡ æˆ‘ä»¬ä¸æ˜¯å¾ˆåœ¨ä¹aåˆ°åº•æ˜¯ä»€ä¹ˆï¼Œfåˆ°åº•æ˜¯ä»€ä¹ˆï¼Œè€Œæ˜¯å…³ç³»afè¿™ä¸ªæ•´ä½“

</aside>

## 3.2 è§£å†³æ–¹æ³•

- å®Œæ•´çš„æ¨ä¸€éKCLå’ŒKVL
    - å¯¹äºæŸäº›å¤æ‚çš„ç”µè·¯å‡ ä¹æ˜¯ä¸å¯èƒ½å®Œæˆçš„
    - å¾ˆéš¾è·å¾—ç¨³å®šæ€§åˆ¤æ®å’Œè£•åº¦
- Two port feedback analysisï¼ˆä¹Ÿæ˜¯æ‹‰æ‰ç»´ä¹¦ä¸Šæåˆ°çš„ï¼‰
    - å¯¹æŸäº›è´Ÿåé¦ˆç”µè·¯æ— æ³•ä½¿ç”¨
- **Return Ratio Analysis**
    - ä¸å†åŒºåˆ†aå’Œfçš„å…·ä½“å€¼ï¼ˆä¸å†åŒºåˆ†å‰å‘å¢ç›Šå’Œåé¦ˆç½‘ç»œçš„ä¼ é€’å‡½æ•°ï¼‰ï¼Œè€Œæ˜¯æ”¾åœ¨ä¸€èµ·çœ‹
    - å…³æ³¨Tçš„å€¼
    - ç¨³å®šæ€§ï¼Œé—­ç¯å¢ç›Šå’Œé˜»æŠ—å˜æ¢å‡è‡³äºTæœ‰å…³

## 3.3 **Return Ratio Analysis**

- **Set all independent sources to zero**
- **Identify a controlled source in the feedback loop that you want to analyze and
break the loop by disconnecting the source**
    - **E.g. VCCS, VCVS, â€¦**
- **Inject a test signal $s_t$ at the breakpoint**
    - **Current or voltage, depending on type of removed source**
- **Find the return signal $s_r$ generated by the controlled source that was
disconnected from the circuit in step 2.**
- **The return ratio of the controlled source is given by $RR=-s_r/s_t$**
    - **Provided that we have chosen a controlled source that breaks the loop
    under consideration (and no other loop), the return ratio of the source is
    equal to the loop gain of the circuit, i.e. RR =**

![Untitled](IMAGE/Untitled%203.png)

$$
v_x=\beta\cdot v_o\\\beta=\frac{C_f}{C_f+C_s+C_X}
$$

$$
v_o=-i_t\cdot(R_o||\frac{1}{sC_{tot}}), C_{Ltot}=C_L+(1-\beta)C_f\\T(s)=-\frac{i_r}{i_t}=-\frac{G_mv_x}{i_t}=\beta\cdot G_m\cdot(R_o||\frac{1}{s_{Ltot}})=\frac{\beta\cdot G_mR_o}{1+sR_oC_{Ltot}}
$$

![Untitled](IMAGE/Untitled%204.png)

æœ€ç»ˆçš„é—­ç¯å¢ç›Šå½¢å¼ï¼šç›´æµå¢ç›Š*ctotlçš„åˆ†å‹*é¢‘ç‡å“åº”éƒ¨åˆ†

![Untitled](IMAGE/Untitled%205.png)

é«˜é¢‘ä¸‹ï¼šæ³¨æ„é«˜é¢‘ä¸‹å¯ä»¥è¿›è¡Œå¿½ç•¥

$$
T(s)=\frac{\beta\cdot G_mR_o}{1+sR_oC_{Ltot}}\approx \frac{\beta\cdot G_m}{sC_{Ltot}}\\|\frac{\beta G_m}{j\omega_cC_{Ltot}}|=1\to \omega_c \approx \frac{\beta G_m}{C_{Ltot}}=\beta\cdot GBW_{OTA}
$$

ç›¸ä½è£•åº¦

![Untitled](IMAGE/Untitled%206.png)

## 3.4 é—­ç¯ä¼ é€’å‡½æ•°

$$
A(s)=\frac{v_o}{v_i}=A_\infin \frac{T(s)}{1+T(s)}+\frac{d}{1+T(s)}
$$

- $**A_\infin$ is the ideal closed loop gain when loop gain T goes to infinity**
- d is the direct signal feedthrough with the controlled source removed (Gmâ†’0)
    - Can often be ignored; we'll look at this term later
    - Be cautious when the feedback loop has explicit feedforward path

![Untitled](IMAGE/Untitled%207.png)

### æ±‚$A_\infin$

å½“Gmè¶‹å‘äºæ— ç©·ï¼ŒVxç‚¹çš„ç”µå‹å€¼å¿…é¡»ä¸º0ï¼Œæ­¤æ—¶æ²¡æœ‰ç”µæµæµç»Cx

$$
0=v_isC_s+v_osC_f\\A_\infin=\frac{C_s}{C_f}
$$

### é—­ç¯ç¯è·¯çš„å¸¦å®½

$$
T(s)=\frac{\beta \cdot G_mR_o}{1+sR_oC_{Ltot}}\approx \frac{\beta \cdot G_m}{sC_{Ltot}}=\frac{\omega_c}{s}(high \ freqency)
$$

$$
A(s)\approx A_\infin \frac{T(s)}{1+T(s)}\approx A_\infin \frac{\omega_c}{s+\omega_c},|\frac{\omega_c}{jw_{-3dB}+\omega_c}|=\frac{1}{\sqrt{2}}\to\omega_{-3dB}=\omega_c
$$

- é—­ç¯ç³»ç»Ÿå¸¦å®½ç­‰äºT(s)çš„GBW
- é—­ç¯ç³»ç»Ÿçš„æç‚¹æ¯”å¼€ç¯ç³»ç»Ÿçš„æç‚¹å¤§$T_0$å€

$$
\omega_{-3dB}\approx \omega_pT_0=\frac{1}{C_{Ltot}R_o}\cdot \beta G_mR_o=\omega_c
$$

### æ±‚d

ç›´æ¥å†™å‡ºä¸€ä¸ªdçš„è¡¨è¾¾å¼ä¼šå˜å¾—æ¯”è¾ƒå¤æ‚

å¯ä»¥æ±‚ä¸¤ä¸ªæé™ï¼ˆä½é¢‘æé™å’Œé«˜é¢‘æé™ï¼‰ä¸‹çš„æƒ…å†µ

- ä½é¢‘$R_o<<|1/j\omega_c|$
    - d=0ï¼Œæ— å‰é¦ˆé€šè·¯
- é«˜é¢‘$R_o>>|1/j\omega_c|$
    - calculating feedforward zeros is easier using simple KCL
    analysis, with large resistors removed

![Untitled](IMAGE/Untitled%208.png)

### è¯¯å·®

ç»™æ— ç©·é•¿çš„æ—¶é—´ï¼Œæœ€ç»ˆèƒ½settleåˆ°ä»€ä¹ˆä½ç½®

**static gain error**

$$
\epsilon_0=\frac{A_0-A_\infin}{A_\infin}=\frac{A_0}{A_\infin}-1=\frac{T_0}{1+T_0}-1=\frac{1}{1+\frac{1}{T_0}}-1\approx(1-\frac{1}{T_0})-1=-\frac{1}{T_0}
$$

$$
|\epsilon_0|\approx\frac{1}{T_0}
$$

## 3.5 Summary of OTA with cap.

- å¯»æ‰¾ä½é¢‘å¢ç›Šè¯¯å·®
    - å†™å‡ºä½é¢‘çš„ç¯è·¯å¢ç›Šè¡¨è¾¾å¼ï¼Œå¿½ç•¥æ‰€æœ‰ç”µå®¹å¸¦æ¥çš„é˜»æŠ—åˆ†å‹
    - éœ€è¦æ³¨æ„ç”µå®¹åˆ†å‹ç½‘ç»œä¾ç„¶æ˜¯èµ·ä½œç”¨çš„ï¼ˆå¿½ç•¥å°ç”µå®¹ï¼‰
- é—­ç¯å¸¦å®½
    - å†™å‡ºé«˜é¢‘ä¸‹çš„ç¯è·¯å¢ç›Šè¡¨è¾¾å¼ï¼Œå¿½ç•¥æ‰€æœ‰æœ‰é™è¾“å‡ºé˜»æŠ—çš„å™¨ä»¶
    - é—­ç¯ç³»ç»Ÿçš„-3dBå¸¦å®½çº¦ç­‰äºç¯è·¯å¢ç›Šçš„UGB
- ç¨³å®šæ€§å’Œç›¸ä½è£•åº¦
    - ç¯è·¯å¢ç›Šçš„ç›¸ä½å’ŒUGB

<aside>
ğŸ’¡ æƒ³çœ‹å“ªä¸ªé¢‘ç‡å°±å¾€å“ªä¸ªæ–¹å‘æ¨å¯¼

</aside>

![Untitled](IMAGE/Untitled%209.png)

# 4. Circuit Example

æ±‚ç¯è·¯å¢ç›Š

![Untitled](IMAGE/Untitled%2010.png)

- è¾“å…¥çŸ­æ¥ï¼Œè¾“å‡ºæ–­æ‰
- åœ¨å—æ§æºä¸Šæ–­å¼€ï¼Œè¡¥ä¸€ä¸ªç”µæµæº
- ç»•ä¸€åœˆçœ‹æœ‰å¤šå°‘ç¯è·¯å¢ç›Š

å¦‚ä½•åœ¨SPICEä»¿çœŸä¸­ä»¿çœŸè¿™äº›å†…å®¹ï¼š

![Untitled](IMAGE/Untitled%2011.png)

<aside>
ğŸ’¡ ä¸€ä¸ªå®é™…æ¨¡å‹ä¸­æ˜¯æ— æ³•æ–­å¼€çš„

</aside>

## 4.1 ä»¿çœŸ

![Untitled](IMAGE/Untitled%2012.png)

### Middlebrook

![Untitled](IMAGE/Untitled%2013.png)

![Untitled](IMAGE/Untitled%2014.png)

<aside>
ğŸ’¡ ç”¨stbä»¿çœŸ

</aside>

![Untitled](IMAGE/Untitled%2015.png)

![Untitled](IMAGE/Untitled%2016.png)

## 4.2 å…¨å·®åˆ†ç”µè·¯

ä½¿ç”¨CMDM Prob

- -1æ˜¯å·®æ¨¡
- 1æ˜¯å…±æ¨¡

![Untitled](IMAGE/Untitled%2017.png)

## 4.3 å¤šç¯è·¯åˆ†æ

æœ‰æ²¡æœ‰ä¸€ä¸ªç‚¹å¯ä»¥æŠŠæ‰€æœ‰ç¯è·¯éƒ½æ–­æ‰ï¼Œåœ¨é‚£ä¸ªç‚¹æ’å…¥prob

# **Always run one or more transient analyses for a "true" stability check!**

---

# Feedback and Stability Analysis Summary

### Feedback and Stability Analysis å†…å®¹ç›®å½•

1. **è´Ÿåé¦ˆåˆ†æ**
    1. 1.1 Reference
    2. 1.2 è´Ÿåé¦ˆ
    3. 1.3 ç†æƒ³åé¦ˆç³»ç»Ÿçš„å‰æå‡è®¾
    4. 1.4 å¯¹å¢ç›Šç¨³å®šæ€§çš„æ”¹å–„
    5. 1.5 è´Ÿåé¦ˆçš„æ¨¡å¼
    6. 1.6 è´Ÿåé¦ˆå¯¹è¾“å…¥è¾“å‡ºé˜»æŠ—çš„å½±å“
2. **ç¨³å®šæ€§ä¸ç¨³å®šæ€§åˆ¤æ®**
    1. 2.1 Barkhausenç¨³å®šæ€§åˆ¤æ®
    2. 2.2 Nyquist Stabilityç¨³å®šæ€§åˆ¤æ®
3. **ç”µå®¹è´Ÿåé¦ˆçš„æ”¾å¤§å™¨**
    1. 3.1 å†™å‡ºå°ä¿¡å·æ¨¡å‹
    2. 3.2 è§£å†³æ–¹æ³•
    3. 3.3 Return Ratio Analysis
    4. 3.4 é—­ç¯ä¼ é€’å‡½æ•°
    5. 3.5 Summary of OTA with cap.
4. **Circuit Example**
5. **Note**

# 1. è´Ÿåé¦ˆåˆ†æ

åé¦ˆæ˜¯ç”µè·¯ä¸­é‡è¦çš„æ”¯ç‚¹

## 1.1 Reference

- H.W. Bode, *Network Analysis and Feedback Amplifier Design*, Van Nostrand, New York, 1945.
- R.D. Middlebrook, "Measurement of Loop Gain in Feedback Systems," Int. J. Electronics, Vol. 38, No.4, .pp. 485-512, 1975.
- S. Rosenstark, "Loop Gain Measurement in Feedback Amplifiers," Int. J. Electronics, Vol. 57, No.3., pp. 415-421, 1984.
- P.J. Hurst, "Exact Simulation of Feedback Circuit Parameters," Trans. on Circuits and Systems, pp.1382-1389, Nov. 1991.
- P.J. Hurst, S.H. Lewis, "Simulation of Return Ratio in Fully Differential Feedback Circuits," Proc. CICC 1994, pp.29-32.
- Ken Kundert, "A Test Bench for Differential Circuits," Online: http://www.designers-guide.com/Analysis/diff.pdf
- M. Tian, V. Visvanathan, J. Hantgan, K. Kundert, "Striving for small-signal stability," IEEE Circuits and Devices Magazine, pp. 31-41, January 2001.

## 1.2 è´Ÿåé¦ˆ

<aside>
ğŸ’¡ Feedback is everywhere

</aside>

### å¥½å¤„

- é™ä½å¯¹å¤–ç•Œå˜åŒ–çš„æ•æ„Ÿåº¦ï¼ˆPVTï¼‰
- é™ä½å¤±çœŸï¼ˆé«˜æ¬¡é¡¹è¢«å¹³æ–¹å€è¡°å‡ï¼‰
- å‘æˆ‘ä»¬å¸Œæœ›çš„æ–¹å‘ä¸Šå»æ”¹å˜é˜»æŠ—
- å¢åŠ å¸¦å®½

### ä»£ä»·

- ç‰ºç‰²å¢ç›Š
- æ½œåœ¨çš„ä¸ç¨³å®šæ€§ï¼ˆç¯è·¯ç¨³å®šæ€§ï¼‰

æŠŠç”µè·¯åˆ†ä¸ºå‰é¦ˆé€šè·¯ä¸åé¦ˆå›è·¯

## 1.3 ç†æƒ³åé¦ˆç³»ç»Ÿçš„å‰æå‡è®¾

1. æ— è®ºæ˜¯å‰é¦ˆæ”¾å¤§å™¨è¿˜æ˜¯åé¦ˆé€šè·¯éƒ½æ²¡æœ‰loading
2. å‰é¦ˆé€šè·¯å’Œåé¦ˆå›è·¯éƒ½æ˜¯å•å‘çš„ï¼Œæ²¡æœ‰å…¶ä»–æ–¹å‘çš„ä¼ è¾“

![Untitled](IMAGE/Untitled%2018.png)

$$
S_o=a\cdot S_{\epsilon}\\S_{fb}=f\cdot S_o\\S_\epsilon=S_i-S_{fb}
$$

$$
S_o=a(S_i-S_{fb})=a(S_i-f\cdot S_o)
$$

### Loop Gain

$$
T=af=\frac{S_{fb}}{S_{\epsilon}}
$$

### Closed Loop Gain

$$
A=\frac{S_o}{S_i}=\frac{a}{1+af}
$$

$$
A=\frac{a}{1+T}
$$

If T >> 1

$$
A\approx \frac{a}{T}=\frac{1}{f}
$$

åé¦ˆå›è·¯ä½œç”¨ä¸ºæœ€å°åŒ–è¯¯å·®ä¿¡å·$S_{\epsilon}$ï¼Œå¹¶ä½¿åé¦ˆä¿¡å·$S_{fb}$è¿½è¸ªè¾“å…¥ä¿¡å·$S_i$

$$
S_{\epsilon}=S_i-f\cdot S_o=S_i-f\cdot(\frac{a}{1+af})S_i=(1-\frac{af}{1+af})\cdot S_i
$$

è¯¯å·®é‡

$$
\frac{S_{\epsilon}}{S_i}=1-\frac{T}{1+T}=\frac{1}{1+T}
$$

åé¦ˆé‡

$$
\frac{S_{fb}}{S_i}=a\cdot f(\frac{S_{\epsilon}}{S_i})=\frac{T}{1+T}
$$

## 1.4 å¯¹å¢ç›Šç¨³å®šæ€§çš„æ”¹å–„

åé¦ˆç½‘ç»œä¸€èˆ¬æ˜¯ç”±ç²¾ç¡®çš„è¢«åŠ¨å…ƒä»¶ç»„æˆçš„ç½‘ç»œä¸”ä¸€èˆ¬ä¸é¢‘ç‡æ— å…³ï¼Œå‰å‘æ”¾å¤§å™¨çš„å¢ç›Šä¸€èˆ¬å¾ˆå¤§ï¼Œä½†å¯æ§åº¦ä¸é«˜ã€‚

è´Ÿåé¦ˆé™¤äº†é™ä½äº†å¢ç›Šï¼Œä¹Ÿé™ä½äº†å¢ç›Šçš„ä¸ç¨³å®šåº¦ä¸ºåŸæ¥çš„ï¼ˆ1+Tï¼‰åˆ†ä¹‹ä¸€

$$
\frac{dA}{da}=\frac{d}{da}(\frac{a}{1+af})=\frac{1}{1+af}+a\frac{d}{da}(\frac{1}{1+af})\\=\frac{(1+af)-af}{(1+af)^2}=\frac{1}{(1+af)^2}=\frac{1}{(1+T)^2}
$$

å½“aå‘ç”Ÿäº†$\delta a$çš„æ”¹å˜

$$
\delta A=\frac{dA}{da}\delta a=\frac{\delta a}{(1+T)^2}
$$

$$
\frac{\delta A}{A}=\frac{\delta a}{(1+T)^2}(\frac{1+T}{a})=\frac{1}{1+T}\frac{\delta a}{a}
$$

## 1.5 è´Ÿåé¦ˆçš„æ¨¡å¼

få’ŒåŠ æ³•å™¨å…·ä½“æ˜¯æ€ä¹ˆå®ç°çš„

- At the OUTPUT
    - A shunt connection senses the output voltage
    - A series connection senses the output current
- At the INPUT
    - A shunt connection feeds back a current in parallel with the input
    - A series connection feeds back a voltage in series with the input

![Untitled](IMAGE/Untitled%2019.png)

![Untitled](IMAGE/Untitled%2020.png)

![Untitled](IMAGE/Untitled%2021.png)

![Untitled](IMAGE/Untitled%2022.png)

<aside>
ğŸ’¡ æˆ‘ä»¬æ›´åœ¨ä¹çš„å®é™…ä¸Šæ˜¯T

</aside>

## 1.6 è´Ÿåé¦ˆå¯¹è¾“å…¥è¾“å‡ºé˜»æŠ—çš„å½±å“

<aside>
ğŸ’¡ **Feedback always helps the loading and the driving**

</aside>

- Input impedance
    - For voltage input, it increases the input impedance by (1+T)
    - For current input, it lowers the input impedance by (1+T)
- Output impedance
    - For voltage output, it lowers the output impedance by (1+T)
    - For current output, it increases the output impedance by (1+T)

CCIA: cap coupled instrument amp. ä¸€èˆ¬ä½¿ç”¨ä¸€ä¸ªchopæ¥å°†offsetå˜æˆä¸€ä¸ªrippleã€‚ä½†åŠ å…¥chopä¼šå¯¼è‡´è¾“å…¥é˜»æŠ—é™ä½

# 2. ç¨³å®šæ€§ä¸ç¨³å®šæ€§åˆ¤æ®

ç¨³å®šæ€§ï¼šBIBOï¼Œæœ‰ç•Œè¾“å…¥ï¼Œæœ‰ç•Œè¾“å‡º

![Untitled](IMAGE/Untitled%2023.png)

$$
A(s)=\frac{v_o}{v_i}=\frac{a(s)}{1+a(s)f(s)}=\frac{a(s)}{1+T(s)}
$$

ä¸€ä¸ªè¿ç»­æ—¶é—´çº¿æ€§ç³»ç»Ÿå¦‚æœæ‰€æœ‰æç‚¹é¢‘ç‡éƒ½åœ¨så¹³é¢çš„å·¦åŠå¹³é¢åˆ™æ˜¯BIBOç¨³å®šçš„

- å¯ä»¥é€šè¿‡è®¡ç®—1+T(s)çš„æ ¹æ¥æ£€æŸ¥ç¨³å®šæ€§
    - æ•°å­¦ä¸Šå¯è¡Œï¼Œä½†æœ‰æ—¶å¾ˆéš¾å…·ä½“å®æ–½

## 2.1  Barkhausenç¨³å®šæ€§åˆ¤æ®

ç›¸ä½=180åº¦ï¼Œå¢ç›Šï¼1

System is unstable when |T(jÏ‰)| > 1 @ frequency where Phase(T(jÏ‰)) = -180Â°

- Can use simple bode plot to check for stability
- Safe to use in many electronic circuits
- However, it is **not** mathematically rigorous, be aware of exceptions
- It is **not** good at analyzing more complicated transfer functions
    - T(s) of a phase-locked loop
    - T(s) with a right-half plane pole

![Untitled](IMAGE/Untitled%2024.png)

<aside>
ğŸ’¡ ç›¸ä½è£•åº¦æœ€ä¼˜è¦è¾¾åˆ°60~70Â°

</aside>

å¢ç›Šè£•åº¦ï¼šç›¸ä½è¾¾åˆ°180åº¦çš„æ—¶å€™å¢ç›Šæ˜¯ä¸æ˜¯å°äº1äº†ï¼ˆå¸Œæœ›è·ç¦»1æœ‰3~5çš„è£•åº¦ï¼‰

![Untitled](IMAGE/Untitled%2025.png)

## 2.2  Nyquist Stabilityç¨³å®šæ€§åˆ¤æ®

ç›´æ¥åˆ†æ1+T(s)ï¼ˆT(s)çš„æç‚¹å¯èƒ½å’Œ1+T(s)æœ‰æ˜æ˜¾çš„ä¸åŒï¼‰

å¥ˆå¥æ–¯ç‰¹ç¨³å®šæ€§åˆ¤æ®

![Untitled](IMAGE/Untitled.png)

Good online tutorial videos:

- [https://www.youtube.com/watch?v=sof3meN96MA](https://www.youtube.com/watch?v=sof3meN96MA)
- [https://www.youtube.com/watch?v=FXbKYT1G6Xs](https://www.youtube.com/watch?v=FXbKYT1G6Xs)

<aside>
ğŸ’¡ å¥ˆå¥æ–¯ç‰¹åˆ¤æ®æ˜¯ä¸€ä¸ªæ›´å…¨é¢çš„åˆ¤æ®ï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹ç”¨å·´å…‹è±ªæ–¯ç¨³å®šæ€§åˆ¤æ®ä¹Ÿå¤Ÿç”¨äº†

</aside>

# 3. ç”µå®¹è´Ÿåé¦ˆçš„æ”¾å¤§å™¨

ä»¥ä»¥ä¸‹ç”µå®¹è´Ÿåé¦ˆæ”¾å¤§å™¨ä¸ºä¾‹åˆ†æ

![Untitled](IMAGE/Untitled%201.png)

åˆ†æè¯¥ç”µè·¯çš„ï¼š

- ç”µè·¯çš„ç¨³å®šæ€§ï¼Œç›¸ä½è£•åº¦æ˜¯å¤šå°‘
- ä½é¢‘é—­ç¯å¢ç›Šæ˜¯å¤šå°‘
- é—­ç¯å¸¦å®½æ˜¯å¤šå°‘

## 3.1 å†™å‡ºå°ä¿¡å·æ¨¡å‹

è§‚å¯Ÿå°ä¿¡å·æ¨¡å‹å‘ç°**å¾ˆéš¾**å†™æˆæ ‡å‡†çš„è´Ÿåé¦ˆé—­ç¯ï¼ˆafï¼‰å½¢å¼

- è´Ÿåé¦ˆç½‘ç»œä½œä¸ºè¿æ”¾çš„è´Ÿè½½çš„ä¸€éƒ¨åˆ†
- è¿æ”¾ä¹Ÿæ˜¯è´Ÿåé¦ˆç½‘ç»œçš„ä¸€éƒ¨åˆ†
- é«˜é¢‘ä¸‹æœ‰ä¸€æ¡bypassæ”¾å¤§å™¨çš„å‰é¦ˆé€šè·¯

![Untitled](IMAGE/Untitled%202.png)

<aside>
ğŸ’¡ æˆ‘ä»¬ä¸æ˜¯å¾ˆåœ¨ä¹aåˆ°åº•æ˜¯ä»€ä¹ˆï¼Œfåˆ°åº•æ˜¯ä»€ä¹ˆï¼Œè€Œæ˜¯å…³ç³»afè¿™ä¸ªæ•´ä½“

</aside>

## 3.2 è§£å†³æ–¹æ³•

- å®Œæ•´çš„æ¨ä¸€éKCLå’ŒKVL
    - å¯¹äºæŸäº›å¤æ‚çš„ç”µè·¯å‡ ä¹æ˜¯ä¸å¯èƒ½å®Œæˆçš„
    - å¾ˆéš¾è·å¾—ç¨³å®šæ€§åˆ¤æ®å’Œè£•åº¦
- Two port feedback analysisï¼ˆä¹Ÿæ˜¯æ‹‰æ‰ç»´ä¹¦ä¸Šæåˆ°çš„ï¼‰
    - å¯¹æŸäº›è´Ÿåé¦ˆç”µè·¯æ— æ³•ä½¿ç”¨
- **Return Ratio Analysis**
    - ä¸å†åŒºåˆ†aå’Œfçš„å…·ä½“å€¼ï¼ˆä¸å†åŒºåˆ†å‰å‘å¢ç›Šå’Œåé¦ˆç½‘ç»œçš„ä¼ é€’å‡½æ•°ï¼‰ï¼Œè€Œæ˜¯æ”¾åœ¨ä¸€èµ·çœ‹
    - å…³æ³¨Tçš„å€¼
    - ç¨³å®šæ€§ï¼Œé—­ç¯å¢ç›Šå’Œé˜»æŠ—å˜æ¢å‡è‡³äºTæœ‰å…³

## 3.3 **Return Ratio Analysis**

- **Set all independent sources to zero**
- **Identify a controlled source in the feedback loop that you want to analyze and
break the loop by disconnecting the source**
    - **E.g. VCCS, VCVS, â€¦**
- **Inject a test signal $s_t$ at the breakpoint**
    - **Current or voltage, depending on type of removed source**
- **Find the return signal $s_r$ generated by the controlled source that was
disconnected from the circuit in step 2.**
- **The return ratio of the controlled source is given by $RR=-s_r/s_t$**
    - **Provided that we have chosen a controlled source that breaks the loop
    under consideration (and no other loop), the return ratio of the source is
    equal to the loop gain of the circuit, i.e. RR =**

![Untitled](IMAGE/Untitled%203.png)

$$
v_x=\beta\cdot v_o\\\beta=\frac{C_f}{C_f+C_s+C_X}
$$

$$
v_o=-i_t\cdot(R_o||\frac{1}{sC_{tot}}), C_{Ltot}=C_L+(1-\beta)C_f\\T(s)=-\frac{i_r}{i_t}=-\frac{G_mv_x}{i_t}=\beta\cdot G_m\cdot(R_o||\frac{1}{s_{Ltot}})=\frac{\beta\cdot G_mR_o}{1+sR_oC_{Ltot}}
$$

![Untitled](IMAGE/Untitled%204.png)

æœ€ç»ˆçš„é—­ç¯å¢ç›Šå½¢å¼ï¼šç›´æµå¢ç›Š*ctotlçš„åˆ†å‹*é¢‘ç‡å“åº”éƒ¨åˆ†

![Untitled](IMAGE/Untitled%205.png)

é«˜é¢‘ä¸‹ï¼šæ³¨æ„é«˜é¢‘ä¸‹å¯ä»¥è¿›è¡Œå¿½ç•¥

$$
T(s)=\frac{\beta\cdot G_mR_o}{1+sR_oC_{Ltot}}\approx \frac{\beta\cdot G_m}{sC_{Ltot}}\\|\frac{\beta G_m}{j\omega_cC_{Ltot}}|=1\to \omega_c \approx \frac{\beta G_m}{C_{Ltot}}=\beta\cdot GBW_{OTA}
$$

ç›¸ä½è£•åº¦

![Untitled](IMAGE/Untitled%206.png)

## 3.4 é—­ç¯ä¼ é€’å‡½æ•°

$$
A(s)=\frac{v_o}{v_i}=A_\infin \frac{T(s)}{1+T(s)}+\frac{d}{1+T(s)}
$$

- $**A_\infin$ is the ideal closed loop gain when loop gain T goes to infinity**
- d is the direct signal feedthrough with the controlled source removed (Gmâ†’0)
    - Can often be ignored; we'll look at this term later
    - Be cautious when the feedback loop has explicit feedforward path

![Untitled](IMAGE/Untitled%207.png)

### æ±‚$A_\infin$

å½“Gmè¶‹å‘äºæ— ç©·ï¼ŒVxç‚¹çš„ç”µå‹å€¼å¿…é¡»ä¸º0ï¼Œæ­¤æ—¶æ²¡æœ‰ç”µæµæµç»Cx

$$
0=v_isC_s+v_osC_f\\A_\infin=\frac{C_s}{C_f}
$$

### é—­ç¯ç¯è·¯çš„å¸¦å®½

$$
T(s)=\frac{\beta \cdot G_mR_o}{1+sR_oC_{Ltot}}\approx \frac{\beta \cdot G_m}{sC_{Ltot}}=\frac{\omega_c}{s}(high \ freqency)
$$

$$
A(s)\approx A_\infin \frac{T(s)}{1+T(s)}\approx A_\infin \frac{\omega_c}{s+\omega_c},|\frac{\omega_c}{jw_{-3dB}+\omega_c}|=\frac{1}{\sqrt{2}}\to\omega_{-3dB}=\omega_c
$$

- é—­ç¯ç³»ç»Ÿå¸¦å®½ç­‰äºT(s)çš„GBW
- é—­ç¯ç³»ç»Ÿçš„æç‚¹æ¯”å¼€ç¯ç³»ç»Ÿçš„æç‚¹å¤§$T_0$å€

$$
\omega_{-3dB}\approx \omega_pT_0=\frac{1}{C_{Ltot}R_o}\cdot \beta G_mR_o=\omega_c
$$

### æ±‚d

ç›´æ¥å†™å‡ºä¸€ä¸ªdçš„è¡¨è¾¾å¼ä¼šå˜å¾—æ¯”è¾ƒå¤æ‚

å¯ä»¥æ±‚ä¸¤ä¸ªæé™ï¼ˆä½é¢‘æé™å’Œé«˜é¢‘æé™ï¼‰ä¸‹çš„æƒ…å†µ

- ä½é¢‘$R_o<<|1/j\omega_c|$
    - d=0ï¼Œæ— å‰é¦ˆé€šè·¯
- é«˜é¢‘$R_o>>|1/j\omega_c|$
    - calculating feedforward zeros is easier using simple KCL
    analysis, with large resistors removed

![Untitled](IMAGE/Untitled%208.png)

### è¯¯å·®

ç»™æ— ç©·é•¿çš„æ—¶é—´ï¼Œæœ€ç»ˆèƒ½settleåˆ°ä»€ä¹ˆä½ç½®

**static gain error**

$$
\epsilon_0=\frac{A_0-A_\infin}{A_\infin}=\frac{A_0}{A_\infin}-1=\frac{T_0}{1+T_0}-1=\frac{1}{1+\frac{1}{T_0}}-1\approx(1-\frac{1}{T_0})-1=-\frac{1}{T_0}
$$

$$
|\epsilon_0|\approx\frac{1}{T_0}
$$

## 3.5 Summary of OTA with cap.

- å¯»æ‰¾ä½é¢‘å¢ç›Šè¯¯å·®
    - å†™å‡ºä½é¢‘çš„ç¯è·¯å¢ç›Šè¡¨è¾¾å¼ï¼Œå¿½ç•¥æ‰€æœ‰ç”µå®¹å¸¦æ¥çš„é˜»æŠ—åˆ†å‹
    - éœ€è¦æ³¨æ„ç”µå®¹åˆ†å‹ç½‘ç»œä¾ç„¶æ˜¯èµ·ä½œç”¨çš„ï¼ˆå¿½ç•¥å°ç”µå®¹ï¼‰
- é—­ç¯å¸¦å®½
    - å†™å‡ºé«˜é¢‘ä¸‹çš„ç¯è·¯å¢ç›Šè¡¨è¾¾å¼ï¼Œå¿½ç•¥æ‰€æœ‰æœ‰é™è¾“å‡ºé˜»æŠ—çš„å™¨ä»¶
    - é—­ç¯ç³»ç»Ÿçš„-3dBå¸¦å®½çº¦ç­‰äºç¯è·¯å¢ç›Šçš„UGB
- ç¨³å®šæ€§å’Œç›¸ä½è£•åº¦
    - ç¯è·¯å¢ç›Šçš„ç›¸ä½å’ŒUGB

<aside>
ğŸ’¡ æƒ³çœ‹å“ªä¸ªé¢‘ç‡å°±å¾€å“ªä¸ªæ–¹å‘æ¨å¯¼

</aside>

![Untitled](IMAGE/Untitled%209.png)

# 4. Circuit Example

æ±‚ç¯è·¯å¢ç›Š

![Untitled](IMAGE/Untitled%2010.png)

- è¾“å…¥çŸ­æ¥ï¼Œè¾“å‡ºæ–­æ‰
- åœ¨å—æ§æºä¸Šæ–­å¼€ï¼Œè¡¥ä¸€ä¸ªç”µæµæº
- ç»•ä¸€åœˆçœ‹æœ‰å¤šå°‘ç¯è·¯å¢ç›Š

å¦‚ä½•åœ¨SPICEä»¿çœŸä¸­ä»¿çœŸè¿™äº›å†…å®¹ï¼š

![Untitled](IMAGE/Untitled%2011.png)

<aside>
ğŸ’¡ ä¸€ä¸ªå®é™…æ¨¡å‹ä¸­æ˜¯æ— æ³•æ–­å¼€çš„

</aside>

## 4.1 ä»¿çœŸ

![Untitled](IMAGE/Untitled%2012.png)

### Middlebrook

![Untitled](IMAGE/Untitled%2013.png)

![Untitled](IMAGE/Untitled%2014.png)

<aside>
ğŸ’¡ ç”¨stbä»¿çœŸ

</aside>

![Untitled](IMAGE/Untitled%2015.png)

![Untitled](IMAGE/Untitled%2016.png)

## 4.2 å…¨å·®åˆ†ç”µè·¯

ä½¿ç”¨CMDM Prob

- -1æ˜¯å·®æ¨¡
- 1æ˜¯å…±æ¨¡

![Untitled](IMAGE/Untitled%2017.png)

## 4.3 å¤šç¯è·¯åˆ†æ

æœ‰æ²¡æœ‰ä¸€ä¸ªç‚¹å¯ä»¥æŠŠæ‰€æœ‰ç¯è·¯éƒ½æ–­æ‰ï¼Œåœ¨é‚£ä¸ªç‚¹æ’å…¥prob

# **Always run one or more transient analyses for a "true" stability check!**